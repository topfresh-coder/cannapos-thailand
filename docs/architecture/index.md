# Cannabis Dispensary POS System - Technical Architecture Document

## Table of Contents

- [Cannabis Dispensary POS System - Technical Architecture Document](#table-of-contents)
  - [Introduction](./introduction.md)
    - [Starter Template or Existing Project](./introduction.md#starter-template-or-existing-project)
    - [Change Log](./introduction.md#change-log)
  - [High Level Architecture](./high-level-architecture.md)
    - [Technical Summary](./high-level-architecture.md#technical-summary)
    - [Platform and Infrastructure Choice](./high-level-architecture.md#platform-and-infrastructure-choice)
    - [Repository Structure](./high-level-architecture.md#repository-structure)
    - [High Level Architecture Diagram](./high-level-architecture.md#high-level-architecture-diagram)
    - [Architectural Patterns](./high-level-architecture.md#architectural-patterns)
  - [Tech Stack](./tech-stack.md)
  - [Data Models](./data-models.md)
    - [User](./data-models.md#user)
    - [Location](./data-models.md#location)
    - [Product](./data-models.md#product)
    - [ProductBatch](./data-models.md#productbatch)
    - [PricingTier](./data-models.md#pricingtier)
    - [Shift](./data-models.md#shift)
    - [ShiftDefinition](./data-models.md#shiftdefinition)
    - [Transaction](./data-models.md#transaction)
    - [TransactionItem](./data-models.md#transactionitem)
    - [InventoryAdjustment](./data-models.md#inventoryadjustment)
    - [StockCount](./data-models.md#stockcount)
    - [StockCountItem](./data-models.md#stockcountitem)
  - [Database Schema](./database-schema.md)
    - [Entity Relationship Diagram (ERD)](./database-schema.md#entity-relationship-diagram-erd)
    - [PostgreSQL Schema (Supabase)](./database-schema.md#postgresql-schema-supabase)
    - [Row-Level Security (RLS) Policies](./database-schema.md#row-level-security-rls-policies)
  - [Application Architecture](./application-architecture.md)
    - [Component Structure](./application-architecture.md#component-structure)
    - [State Management Patterns](./application-architecture.md#state-management-patterns)
  - [API Design](./api-design.md)
  - [Business Logic](./business-logic.md)
    - [Tier Pricing Calculation Algorithm](./business-logic.md#tier-pricing-calculation-algorithm)
    - [FIFO Allocation Implementation](./business-logic.md#fifo-allocation-implementation)
    - [Shift Variance Calculation](./business-logic.md#shift-variance-calculation)
  - [Security Model](./security-model.md)
    - [Authentication Flow](./security-model.md#authentication-flow)
    - [RLS Policy Definitions](./security-model.md#rls-policy-definitions)
    - [Role-Based Access Control (RBAC)](./security-model.md#role-based-access-control-rbac)
  - [Performance Strategy](./performance-strategy.md)
    - [Query Optimization](./performance-strategy.md#query-optimization)
    - [Caching Strategy](./performance-strategy.md#caching-strategy)
    - [Code Splitting](./performance-strategy.md#code-splitting)
    - [Bundle Optimization](./performance-strategy.md#bundle-optimization)
  - [Testing Approach](./testing-approach.md)
    - [Unit Test Boundaries](./testing-approach.md#unit-test-boundaries)
    - [Integration Test Scenarios](./testing-approach.md#integration-test-scenarios)
    - [Test Data Strategy](./testing-approach.md#test-data-strategy)
  - [Accessibility Implementation (WCAG 2.1 AA)](./accessibility-implementation-wcag-21-aa.md)
    - [Accessibility Philosophy](./accessibility-implementation-wcag-21-aa.md#accessibility-philosophy)
    - [ARIA Patterns](./accessibility-implementation-wcag-21-aa.md#aria-patterns)
      - [Dialog/Modal Pattern](./accessibility-implementation-wcag-21-aa.md#dialogmodal-pattern)
      - [Live Region Pattern (Cart Updates)](./accessibility-implementation-wcag-21-aa.md#live-region-pattern-cart-updates)
      - [Form Validation Pattern](./accessibility-implementation-wcag-21-aa.md#form-validation-pattern)
    - [Keyboard Navigation](./accessibility-implementation-wcag-21-aa.md#keyboard-navigation)
      - [Global Keyboard Shortcuts](./accessibility-implementation-wcag-21-aa.md#global-keyboard-shortcuts)
      - [Focus Management Rules](./accessibility-implementation-wcag-21-aa.md#focus-management-rules)
      - [Focus Trap Implementation](./accessibility-implementation-wcag-21-aa.md#focus-trap-implementation)
    - [Color Contrast System](./accessibility-implementation-wcag-21-aa.md#color-contrast-system)
      - [Accessible Tailwind Tokens](./accessibility-implementation-wcag-21-aa.md#accessible-tailwind-tokens)
      - [Contrast Ratios](./accessibility-implementation-wcag-21-aa.md#contrast-ratios)
    - [Semantic HTML Structure](./accessibility-implementation-wcag-21-aa.md#semantic-html-structure)
    - [Accessibility Testing](./accessibility-implementation-wcag-21-aa.md#accessibility-testing)
      - [Automated Testing (CI/CD)](./accessibility-implementation-wcag-21-aa.md#automated-testing-cicd)
      - [Manual Testing Checklist](./accessibility-implementation-wcag-21-aa.md#manual-testing-checklist)
    - [Acceptance Criteria Template](./accessibility-implementation-wcag-21-aa.md#acceptance-criteria-template)
  - [Error Handling & Resilience](./error-handling-resilience.md)
    - [Error Handling Philosophy](./error-handling-resilience.md#error-handling-philosophy)
    - [Error Classification](./error-handling-resilience.md#error-classification)
      - [Error Types](./error-handling-resilience.md#error-types)
      - [Error Severity](./error-handling-resilience.md#error-severity)
    - [Error Handling Layers](./error-handling-resilience.md#error-handling-layers)
      - [Layer 1: React ErrorBoundary](./error-handling-resilience.md#layer-1-react-errorboundary)
      - [Layer 2: API Error Interceptor](./error-handling-resilience.md#layer-2-api-error-interceptor)
      - [Layer 3: Form Validation](./error-handling-resilience.md#layer-3-form-validation)
      - [Layer 4: Global Error Handler](./error-handling-resilience.md#layer-4-global-error-handler)
    - [Retry Strategy](./error-handling-resilience.md#retry-strategy)
      - [Network Errors (Exponential Backoff)](./error-handling-resilience.md#network-errors-exponential-backoff)
      - [Non-Retryable Errors](./error-handling-resilience.md#non-retryable-errors)
    - [Error Messages](./error-handling-resilience.md#error-messages)
      - [User-Facing Principles](./error-handling-resilience.md#user-facing-principles)
      - [Error Tracking](./error-handling-resilience.md#error-tracking)
    - [Recovery Actions](./error-handling-resilience.md#recovery-actions)
      - [Automatic Recovery](./error-handling-resilience.md#automatic-recovery)
      - [Manual Recovery](./error-handling-resilience.md#manual-recovery)
  - [Monitoring & Observability](./monitoring-observability.md)
    - [Monitoring Philosophy](./monitoring-observability.md#monitoring-philosophy)
    - [Monitoring Stack](./monitoring-observability.md#monitoring-stack)
    - [Alert Thresholds](./monitoring-observability.md#alert-thresholds)
      - [System Health Alerts](./monitoring-observability.md#system-health-alerts)
      - [Infrastructure Alerts](./monitoring-observability.md#infrastructure-alerts)
    - [Key Metrics](./monitoring-observability.md#key-metrics)
      - [Business Metrics](./monitoring-observability.md#business-metrics)
      - [Technical Metrics](./monitoring-observability.md#technical-metrics)
      - [System Health](./monitoring-observability.md#system-health)
    - [Structured Logging](./monitoring-observability.md#structured-logging)
    - [Operational Dashboard](./monitoring-observability.md#operational-dashboard)
  - [Deployment & Rollback Strategy](./deployment-rollback-strategy.md)
    - [Deployment Pipeline](./deployment-rollback-strategy.md#deployment-pipeline)
    - [Rollback Procedures](./deployment-rollback-strategy.md#rollback-procedures)
      - [Frontend Rollback (Vercel)](./deployment-rollback-strategy.md#frontend-rollback-vercel)
      - [Database Migration Rollback](./deployment-rollback-strategy.md#database-migration-rollback)
      - [Disaster Recovery](./deployment-rollback-strategy.md#disaster-recovery)
  - [Performance Budget](./performance-budget.md)
    - [Bundle Size Budget](./performance-budget.md#bundle-size-budget)
    - [Page Load Budget](./performance-budget.md#page-load-budget)
    - [Monitoring](./performance-budget.md#monitoring)
  - [Next Steps](./next-steps.md)
